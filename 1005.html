<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<title>1005 格尔木市人民医院门诊疾病诊断证明书</title>
		<link href="css/mui.min.css" rel="stylesheet" />
		<link rel="stylesheet" type="text/css" href="css/mui.picker.min.css" />
		<link href="css/mui.picker.css" rel="stylesheet" />
		<link href="css/mui.poppicker.css" rel="stylesheet" />
		<link rel="stylesheet" type="text/css" href="css/app.css" />
		<link rel="stylesheet" type="text/css" href="css/template.css" />
	</head>
	<body>
		<div class="mui-content">
			<form id="form1" name="form1">
				<div class="title mui-content-padded">1 患者个人信息</div>
				<ul class="mui-table-view">
					<li class="mui-table-view-cell">
						<div class="input-group">
							<div class="input-title">患者姓名</div>
							<div class="mui-input-row">
								<input id="patientName" name="patientName" type="text" class="mui-input-clear" placeholder="请填写">
							</div>
						</div>
						<div class="input-group">
							<div class="input-title">性别</div>
							<div class="picker-group" style="padding-left: 0;">
								<select id="sex" name="sex">
									<option value="1" selected>男</option>
									<option value="2">女</option>
								</select>
								<img src="img/row_down.png" alt="" class="picker-icon" />
							</div>
						</div>
						<div class="input-group">
							<div class="input-title">年龄</div>
							<div class="mui-input-row">
								<input id="age" name="age" type="text" class="mui-input-clear" placeholder="请填写">
							</div>
						</div>
						<div class="input-group">
							<div class="input-title">职业</div>
							<div class="mui-input-row">
								<input id="input1" name="input1" type="text" class="mui-input-clear" placeholder="请填写">
							</div>
						</div>
						<div class="input-group">
							<div class="input-title">诊疗号</div>
							<div class="mui-input-row">
								<input id="input2" name="input2" type="text" class="mui-input-clear" placeholder="请填写">
							</div>
						</div>
						<div class="input-group" style="border-bottom: 0;">
							<div class="input-title">身份证号</div>
							<div class="mui-input-row">
								<input id="idNumber" name="idNumber" type="text" class="mui-input-clear" placeholder="请填写">
							</div>
						</div>
					</li>
				</ul>
				<div class="title mui-content-padded">2 其他</div>
				<ul class="mui-table-view">
					<li class="mui-table-view-cell">
						<div class="input-group">
							<div class="input-title">科室</div>
							<div class="mui-input-row">
								<input id="input3" name="input3" type="text" onblur="lengthLimit(this)" class="mui-input-clear" placeholder="请填写">
							</div>
						</div>
						<div class="input-group" >
							<div class="input-title">
								医师
							</div>
							<div class="mui-input-row">
								<input id="input4" name="input4" type="text" onblur="lengthLimit(this)" class="mui-input-clear" placeholder="请填写">
							</div>
						</div>
						<div class="input-group" style="border-bottom: 0;">
							<div class="input-title">就诊时间</div>
							<div class="time-group" style="padding-left: 0;">
								<input readonly type="text" name="input5" id="input5" value="" data-options='{}' class="input-time timePicker" placeholder="请选择">
								<img src="img/row_down.png" alt="" class="picker-icon" />
							</div>
						</div>
					</li>
				</ul>
				<div class="title mui-content-padded">3 简要病历</div>
				<ul class="mui-table-view">
					<li class="mui-table-view-cell">
						<div class="input-group" style="border-bottom: 0;">
							<div class="input-title">主诉</div>
							<div class="mui-input-row">
								<textarea id="input6" name="input6" placeholder="请填写主述内容"></textarea>
							</div>
						</div>
					</li>
				</ul>
				<div class="title mui-content-padded">4 检查所见</div>
				<ul class="mui-table-view">
					<li class="mui-table-view-cell">
						<div class="input-group" style="border-bottom: 0;">
							<div class="mui-input-row">
								<textarea id="input7" name="input7" placeholder="请填写主述内容"></textarea>
							</div>
						</div>
						
					</li>
				</ul>
				<div class="title mui-content-padded">5 主要诊断</div>
				<ul class="mui-table-view">
					<li class="mui-table-view-cell">
						<div class="input-group" style="border-bottom: 0;">
							<div class="mui-input-row">
								<textarea id="input8" name="input8" placeholder="请填写主述内容"></textarea>
							</div>
						</div>
					</li>
				</ul>
				<div class="title mui-content-padded">6 处理意见</div>
				<ul class="mui-table-view">
					<li class="mui-table-view-cell">
						<div class="input-group" style="border-bottom: 0;">
							<div class="mui-input-row">
								<textarea id="input9" name="input9" placeholder="请填写主述内容"></textarea>
							</div>
						</div>
					</li>
				</ul>
			</form>
			<!--<input type="button" value="提交" onclick="submit(FORM_DATA);" />-->
		</div>
		<script src="js/jquery-3.0.0.min.js"></script>
		<script src="js/mui.min.js"></script>
		<script src="js/mui.enterfocus.js"></script>
		<script src="js/mui.picker.js"></script>
		<script src="js/mui.poppicker.js"></script>
		<script src="js/mui.picker.min.js"></script>
		<script src="js/city.data-3.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/ethnic.js" type="text/javascript" charset="utf-8"></script>
		<script src='js/autosize.js'></script>
		<script src="js/app.js" type="text/javascript" charset="utf-8"></script>
		<script>
			'use strict'
			autosize(document.querySelectorAll('textarea'));
			var FORM_DATA = {};
			initFormData(FORM_DATA);
//			document.getElementById('input12').value='eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeennmeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeennmeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeennm';
//		    document.getElementById('input12').style.height=document.getElementById('input12').scrollHeight+'px';
			mui('form').on('change', 'select', function() {
				var name = this.getAttribute("name");
				if(name.indexOf('_TYPE') > -1) {
					var DATA_KEY = name.substr(0, 2) + 'DATA';
					var INDEX = $("select[name=" + name + "]")[0].value - 1;
					setData(FORM_DATA, FORM_DATA[DATA_KEY][INDEX]);
				}
			});
			document.addEventListener('message', function(e) {
				const message = e.data;
				if(JSON.parse(message).type === 'SET') {
					var formData = JSON.parse(JSON.parse(message).formData);
					setData(FORM_DATA, formData);
				} else if(JSON.parse(message).type === 'GET') {
					submit(FORM_DATA);
				}
			});

			function submit(FORM_DATA) {
				$('.edit-time').each(function() {
					this.value = formatTimeString();
				});
				var form1Obj = $("#form1").serializeObject();
				var jsonObj = {};
				for(var key in form1Obj) {
					jsonObj[key] = form1Obj[key];
				}
				console.log(jsonObj)
				sendData(JSON.stringify(jsonObj));
			}
			function lengthLimit(text){
//				if(text.value.length>10){
//					console.log(text.parentElement.previousElementSibling)
//					var ele = text.parentElement.previousElementSibling;
//					if(ele.className==='input-tip'){
//						ele.innerHTML='input-tip';
//					}
//				}
			}
		</script>
	
	</body>
</html>
